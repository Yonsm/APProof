!function(a,b){window.M||(window.M={}),b(window.M[a]=window.M[a]||{})}("client",function(a,b){"use strict";function n(a,b,c){var d;for(d in b)(b.hasOwnProperty(d)&&!(d in a)||c)&&(a[d]=b[d]);return a}function p(b){var c=b.split("."),d=a;return c.forEach(function(a){!d[a]&&(d[a]={}),d=d[a]}),d}function q(a){var b=""+m++;return a&&(j[b]=a),b}function r(c,d,e,f){var h,i,l,g=a.isFunction(c)?c:j[c]||window[c];d=d||[],h=d[0],a.isUndefined(f)&&(f=!0),a.isObject(h)&&("data"in h||(h.data=n({},h)),"code"in h||(h.code=0),h.msg=h.msg||""),a.isFunction(g)?f?setTimeout(function(){g.apply(null,d)},0):g.apply(null,d):console.log("musicapi: not found such callback: "+c),k[c]&&(l=k[c],delete k[c],h&&(h.code!==b?i=h.code:/^-?\d+$/.test(String(h))&&(i=h)))}function s(b){var c=e.call(arguments,1);a.android&&c&&c.length&&c.forEach(function(b,d){a.isObject(b)&&"r"in b&&"result"in b&&(c[d]=b.result)}),r(b,c)}function t(){}function u(b,c){var g,d=null,h=b.split("."),i=b.lastIndexOf("."),j=h[h.length-2],k=h[h.length-1],m=p(b.substring(0,i).replace(/^M\.client\./,""));!c.ios&&c.iOS&&(c.ios=c.iOS),c.support&&!c.support.ios&&c.support.iOS&&(c.support.ios=c.support.iOS),(d=a.ios&&c.ios)?g="ios":(d=a.android&&c.android)&&(g="android"),d&&0!=c.supportInvoke&&(l[j+"."+k]=d),m[k]=d?d:t}function v(a){if(null!=a)if("object"==typeof a)for(var b in a)a[b]=v(a[b]);else"function"!=typeof a&&(a=String(a));return a}function w(c,d,e,f){function i(){s(f,{r:-201,result:"error"})}var g,h=document.createElement("iframe");return h.style.cssText="display:none;width:0px;height:0px;",a.ios&&(h.onload=i,h.src=c),(document.body||document.documentElement).appendChild(h),a.android&&(h.onload=i,h.src=c),g=a.__RETURN_VALUE,a.__RETURN_VALUE=b,setTimeout(function(){h&&h.parentNode&&h.parentNode.removeChild(h)},0),g}function x(b,c,e,f){if(!b||!c||window!==window.top)return null;var g,h;if(a.isFunction(e)?(f=e,e=null):a.isFunction(e&&e.callback)&&!a.isFunction(f)&&(f=e.callback),h=q(f),g=d+"qq.com/"+encodeURIComponent(b)+"/"+encodeURIComponent(c),e){if(a.isObject(e)){try{e=v(e)}catch(i){}e=JSON.stringify(e)}g+="?p="+encodeURIComponent(String(e))}return g+="#"+h,w(g,b,c),null}function y(b,c){var g=l[b+"."+c];return a.isFunction(g)?g.apply(this,e.call(arguments,2)):x.apply(this,e.call(arguments))}function z(a,b){y("core","support",{apiName:(""+a).replace(/^M\.client\./,"")},function(a){"function"==typeof b&&b(a&&a.data&&1==a.data.isSupport?1:0)})}function A(a,b){var c="evt-"+a;return j[c]?j[c].push(b):(j[c]=[b],x("event","on",{event:a})),!0}function B(a,b){var f,c="evt-"+a,d=j[c],e=!1;if(d)if(b)for(f=d.length-1;f>=0;f--)b===d[f]&&d.splice(f,1);else delete j[c],d=null;return d&&d.length||(x("event","off",{event:a}),e=!0),e}function C(a){var b="evt-"+a,c=j[b],d=e.call(arguments,1);c&&c.forEach(function(a){r(a,d,!1)})}function D(a,b,c){x("event","trigger",{event:a,data:b||{},options:c||{}})}var o,c=navigator.userAgent,d="qqmusic://",e=Array.prototype.slice,f=Object.prototype.toString,g=/\b(iPad|iPhone|iPod)\b/i,h=/Android/,i=/QQMUSIC\/(\d[\.\d]*)/i,j=a.__aCallbacks||{},k=a.__aReports||{},l=a.__aFunctions||{},m=1;return n(a,function(){var a={},b="Object,Function,String,Number,Boolean,Date,Undefined,Null";return b.split(",").forEach(function(b){a["is"+b]=function(a){return f.call(a)==="[object "+b+"]"}}),a}()),a.android=h.test(c),a.ios=a.ios=!a.android&&g.test(c),a.version="20160419001",o=c.match(i),a.clientVersion=o&&o[1]&&parseFloat(o[1].replace("0",".")),a.clientVersion>0||(a.clientVersion="0"),m=function(){var b,a=1;for(b in j)j.hasOwnProperty(b)&&(b=Number(b),isNaN(b)||(a=Math.max(a,b)));return++a}(),a.__aCallbacks=j,a.__aReports=k,a.__aFunctions=l,a.__fireCallback=r,a.__scheme=d,n(a,{invoke:y,invokeClient:x,build:u,support:z,execGlobalCallback:s,on:A,off:B,trigger:D,execEventCallback:C},!0),a}),"undefined"!=typeof MusicJsbridge&&MusicJsbridge||(window.MusicJsbridge={isAndroid:!1,callbackDict:{},notificationIdCount:0,bridgeIframe:null,call:function(a,b,c){var f,g,h,i,d=null,e=null;a+="","function"==typeof b?e=b:(d=("string"==typeof b?[b]:b)||d,"function"==typeof c&&(e=c)),f="",f=d instanceof Array&&1==d.length?d[0]:JSON.stringify(d),g={handlerName:a,callbackName:"window.MusicJsbridge._appCallWeb",data:f},h=null,"function"==typeof e&&(h="appcb_"+this.notificationIdCount++ +"_"+ +new Date,this.bind(h,e)),g.callbackId=h,MusicJsbridge.isAndroid?window.console.log(JSON.stringify({handlerName:a,callbackName:"window.MusicJsbridge._appCallWeb",callbackId:h,data:JSON.stringify(d)})):(i="wvjbscheme://y.qq.com?param="+encodeURIComponent(JSON.stringify(g)),this._openScheme(i))},onAPP:function(a,b){this.bind(a,b),this.call(a,{on:1})},offApp:function(a,b){"function"==typeof b?(this.unbind(a,b),this.callbackDict[a]||this.call(a,{on:0})):(this.unbind(a),this.call(a,{on:0}))},bind:function(a,b){this.callbackDict[a]||(this.callbackDict[a]=[]),this.callbackDict[a].push(b)},unbind:function(a,b){var c,d,e;if(1==arguments.length)delete this.callbackDict[a];else if(arguments.length>1&&"function"==typeof b&&this.callbackDict[a]){for(c=this.callbackDict[a],d=0,e=c.length;e>d;d++)if(c[d]==b){c.splice(d,1);break}0==this.callbackDict[a].length&&delete this.callbackDict[a]}},trigger:function(a,b){var c,d,e;if(this.callbackDict[a])for(c=this.callbackDict[a],d=0,e=c.length;e>d;d++)c[d](b)},_appCallWeb:function(a,b){MusicJsbridge.isAndroid?setTimeout(function(){"object"==typeof a&&(MusicJsbridge.trigger(a.responseId,a.response),MusicJsbridge.unbind(a.responseId))},0):setTimeout(function(){var c=null;try{c=JSON.parse(b)}catch(d){c={code:-999}}MusicJsbridge.trigger(a,c.responseData),MusicJsbridge.unbind(a)},0)},_appTriggerWeb:function(a,b){setTimeout(function(){var c=null;if("object"==typeof b)c=b;else try{c=JSON.parse(b)}catch(d){c={code:-999}}MusicJsbridge.trigger(a,c)},0)},_openScheme:function(a){var c;a=a+"&time="+ +new Date,c=document.createElement("iframe"),c.style.display="none",c.src=a,c.id="bridgeIframe",document.body.appendChild(c),setTimeout(function(){try{document.body.removeChild(c),c=null}catch(a){}},1e3)},updateViewport:function(){var c,d,e,f,a=document.head.getElementsByTagName("meta"),b=!1;for(c=0,d=a.length;d>c;c++)e=a[c],"viewport"==e.getAttribute("name")&&(e.setAttribute("content","width="+window.innerWidth+",initial-scale=1,maximum-scale=1,user-scalable=no"),b=!0);b||(f=document.createElement("meta"),f.setAttribute("name","viewport"),f.setAttribute("content","width="+window.innerWidth+",initial-scale=1,maximum-scale=1,user-scalable=no"),document.head.appendChild(f))}},MusicJsbridge.callHandler=MusicJsbridge.call,MusicJsbridge.init=function(){},window.WebViewJavascriptBridge=MusicJsbridge,MusicJsbridge.on=MusicJsbridge.bind,MusicJsbridge.off=MusicJsbridge.unbind,MusicJsbridge.isAndroid=/android/i.test(navigator.userAgent)?!0:!1,function(){var a=window.document.createEvent("Events");a.initEvent("WebViewJavascriptBridgeReady",!0,!0),a.bridge=window.MusicJsbridge,window.document.dispatchEvent(a)}(),function(){window.g_qqmusic_playingTarget=[],window.addEventListener("play",function(a){var b,c,d,e;try{MusicJsbridge.callHandler("music_pause",null,function(){})}catch(a){}if(b=a.target,c=!0,MusicJsbridge.isAndroid&&b&&b.tagName&&/video/i.test(b.tagName))try{MusicJsbridge.callHandler("video_mv_play",null,function(){})}catch(a){}for(d=0,e=g_qqmusic_playingTarget.length;e>d;d++)if(b==g_qqmusic_playingTarget[d]){c=!1;break}c&&g_qqmusic_playingTarget.push(b)},!0),window.QQMusicNativeToStopH5=function(){var b,c,d,e;if("object"==typeof g_qqmusic_playingTarget&&g_qqmusic_playingTarget.length){for(b=[],c=0,d=g_qqmusic_playingTarget.length;d>c;c++)if(e=g_qqmusic_playingTarget[c],e&&"function"==typeof e.pause){try{e.pause()}catch(a){}b.push(e)}g_qqmusic_playingTarget=b}},function(){function a(a,b){var d,e,f,c=document.getElementsByTagName(a);if(c&&c.length)for(d=0,e=c.length;e>d;d++)f=c[d],f.paused||f.ended||b.push(f)}"undefined"==typeof g_qqmusic_playingTarget&&(window.g_qqmusic_playingTarget=[]),a("audio",g_qqmusic_playingTarget),a("vidoe",g_qqmusic_playingTarget)}()}());